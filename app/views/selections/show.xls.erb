<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:html="http://www.w3.org/TR/REC-html40">
  <Styles>
    <Style ss:ID="ce1">
      <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:Indent="0"/>
      <Borders>
        <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
      </Borders>
      <Font ss:Bold="1" ss:Size="7"/>
    </Style>
    <Style ss:ID="ce2">
      <Alignment ss:Vertical="Center"/>
      <Borders>
        <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
      </Borders>
      <Font ss:Bold="1" ss:Size="7"/>
    </Style>
    <Style ss:ID="ce3">
      <Alignment ss:Horizontal="Left" ss:Vertical="Center" ss:Indent="0"/>
      <Borders/>
      <Font ss:Bold="1" ss:Size="7"/>
    </Style>
    <Style ss:ID="ce4">
      <Alignment ss:Vertical="Center"/>
      <Borders/>
      <Font ss:Bold="1" ss:Size="7"/>
    </Style>
    <Style ss:ID="ce5">
      <Alignment ss:Horizontal="Left" ss:Vertical="Center" ss:Indent="0"/>
      <Borders>
        <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
      </Borders>
      <Font ss:Bold="1" ss:Size="7"/>
    </Style>
    <Style ss:ID="ce6">
      <Alignment ss:Rotate="90"  ss:Vertical="Center"  ss:Horizontal="Center"/>
      <Font ss:Bold="1" ss:Size="6"/>
      <Borders>
        <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
      </Borders>
    </Style>
    <Style ss:ID="ce7">
      <Alignment  ss:Vertical="Center"  ss:Horizontal="Center"/>
      <Font ss:Bold="1" ss:Size="6"/>
      <Borders>
        <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
      </Borders>
    </Style>
    <Style ss:ID="ce8">
      <Alignment  ss:Vertical="Center"  ss:Horizontal="Center"/>
      <Font ss:Size="6"/>
      <Borders>
        <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
        <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="0.5" ss:Color="#000000"/>
      </Borders>
    </Style>
  </Styles>
  <Worksheet ss:Name="Testagem">
    <Table>
      <Column ss:Span="1" ss:Width="64.0063"/><Column ss:Index="3" ss:Width="137.6504"/><Column ss:Span="3" ss:Width="64.0063"/><Column ss:Index="8" ss:Width="64.0063"/><Column ss:Span="10" ss:Width="64.0063"/>
      
      <Row ss:AutoFitHeight="0" ss:Height="18.652">
        <Cell ss:MergeAcross="<%= 2*(@drug_test.first.selected_test.count)+8 %>" ss:StyleID="ce1">
        <Data ss:Type="String">COMPROVANTE DE REALIZAÇÃO DE TESTE</Data>
      </Cell>
    </Row>
    <Row ss:AutoFitHeight="0" ss:Height="17.8866">
      <Cell ss:StyleID="ce2">
        <Data ss:Type="String"></Data>
      </Cell>
      <Cell ss:StyleID="ce3" ss:Index="<%= 2*(@drug_test.first.selected_test.count)+1 %>">
        <Data ss:Type="String">DATA:</Data>
      </Cell><Cell/>
      <Cell ss:MergeAcross="3" ss:StyleID="ce4">
        <Data ss:Type="String">RESPONSÁVEL PELA APLICAÇÃO DO TESTE:</Data>
      </Cell>
      <Cell ss:MergeAcross="2" ss:StyleID="ce5">
      <Data ss:Type="String"></Data>
    </Cell>
  </Row>
  <Row ss:AutoFitHeight="0" ss:Height="34.2992">
    <Cell ss:MergeDown="2" ss:StyleID="ce6">
      <Data ss:Type="String">  CÓDIGO</Data>
    </Cell>
    <Cell ss:MergeDown="2" ss:StyleID="ce7">
      <Data ss:Type="String">NOME DO COLABORADOR TRIADO / MATRÍCULA</Data>
      </Cell>
      <Cell ss:MergeDown="2" ss:StyleID="ce7">
        <Data ss:Type="String">ASSINATURA DO COLABORADOR TRIADO</Data>
      </Cell>
      <!--tipo de documento-->

      <Cell ss:MergeDown="2" ss:StyleID="ce7">
       <Data ss:Type="String"><%= "CPF"%></Data>
     </Cell>
     <Cell ss:MergeDown="2" ss:StyleID="ce7">
      <Data ss:Type="String">CARGO</Data>
    </Cell>
    <Cell ss:MergeAcross="1" ss:MergeDown="1" ss:StyleID="ce6">
      <Data ss:Type="String">SEXO</Data>
    </Cell>
    <Cell ss:MergeAcross="1" ss:MergeDown="1" ss:StyleID="ce7">
      <Data ss:Type="String" >FAZ USO DE MEDICAÇÃO COM RECEITA PRESCRITA POR UM PROFISSIONAL DA ÁREA MÉDICA? (SE SIM, QUAL?)</Data>
      </Cell>
      <Cell ss:MergeAcross="<%= 2*(@drug_test.first.selected_test.count)-1 %>" ss:StyleID="ce7">
      <Data ss:Type="String" >SUBSTÂNCIAS ANALISADAS</Data>
    </Cell>
  </Row>
  


  <Row ss:Height="12.1039">
    <% @drug_test.first.selected_test.all.each_with_index do |test, index| %>
    <!--testes types selecionados-->
    <Cell  ss:Index="<%= 10 + index * 2 %>" ss:MergeAcross="1" ss:StyleID="ce7">
      <Data ss:Type="String"><%= test.test_type.short_name %></Data>
    </Cell>
    <% end %>
  </Row>

  <Row ss:AutoFitHeight="0" ss:Height="44.7591">
    <!--sexo-->
    <Cell ss:Index="6" ss:StyleID="ce7"> 
      <Data ss:Type="String">M</Data>
    </Cell>
    <Cell ss:StyleID="ce7">
      <Data ss:Type="String">F</Data>
    </Cell>
    <!--medicação-->
    <Cell ss:StyleID="ce7">
      <Data ss:Type="String">SIM</Data>
    </Cell>
    <Cell ss:StyleID="ce7">
      <Data ss:Type="String">NÃO</Data>
    </Cell>
    <% @drug_test.first.selected_test.all.each do |test| %>
    <!--positivo/negativo test-->
    <Cell  ss:StyleID="ce6">
      <Data ss:Type="String">POSITIVO</Data>
    </Cell>
    <Cell  ss:StyleID="ce6">
      <Data ss:Type="String">NEGATIVO</Data>
    </Cell>
    <% end %>
  </Row>

  <% @drug_test.order("donor_id asc").each_with_index do |drug_test, index| %>   

  <Row ss:AutoFitHeight="0" ss:Height="19.389">
    <!--informações do donor-->
    <!--cod-->
    <Cell ss:StyleID="ce8">
      <Data ss:Type="Number"><%= drug_test.donor_id %></Data>
    </Cell>
    <!--nome-->
    <Cell ss:StyleID="ce8">
      <Data ss:Type="String"><%= drug_test.donor.name%></Data>
    </Cell>
    <!--assinatura-->
    <Cell ss:StyleID="ce8">
      <Data ss:Type="String"><%=""%></Data>
    </Cell>
    <!--num_doc-->
    <Cell ss:Index="4" ss:StyleID="ce8">
      <Data ss:Type="String"><%=drug_test.donor.legal_identifier%></Data>
    </Cell>
    <!--role-->
    <Cell ss:StyleID="ce8">
      <Data ss:Type="String"><%=drug_test.donor.role%></Data>
    </Cell>
    <!--sexo-->
    <% if drug_test.donor.gender == 'M' %>
    <Cell ss:StyleID="ce8">
      <Data ss:Type="String">X</Data>
    </Cell>
    <Cell ss:Index="7" ss:StyleID="ce8">
      <Data ss:Type="String"><%=""%></Data>
    </Cell>
    <% elsif drug_test.donor.gender == 'F'%>
    <Cell ss:StyleID="ce8">
      <Data ss:Type="String"><%=""%></Data>
    </Cell>
    <Cell ss:Index="7" ss:StyleID="ce8">
      <Data ss:Type="String">X</Data>
    </Cell>
    <% else %>
    <Cell ss:StyleID="ce8">
      <Data ss:Type="String"><%=""%></Data>
    </Cell>
    <Cell ss:Index="7" ss:StyleID="ce8">
      <Data ss:Type="String"><%=""%></Data>
    </Cell>
    <% end %> 
    <!--medicação prescrita-->

    <%if drug_test.donor.uses_medication%> 
    <Cell ss:StyleID="ce8">
      <Data ss:Type="String">SIM,
        <%=drug_test.donor.uses_medication_description%> </Data>
      </Cell>
      <Cell ss:Index="9" ss:StyleID="ce8">
        <Data ss:Type="String"><%=""%></Data>
      </Cell>
      <%else%>
      <Cell ss:StyleID="ce8">
        <Data ss:Type="String"><%=""%></Data>
      </Cell>
      <Cell ss:Index="9" ss:StyleID="ce8">
        <Data ss:Type="String">X</Data>
      </Cell>
      <%end%>
      <% drug_test.selected_test.all.each do |test| %>
      <!--positivo-->
      <Cell ss:StyleID="ce7">
        <Data ss:Type="String"></Data>
      </Cell>
      <!--negativo-->
      <Cell ss:StyleID="ce8">
        <Data ss:Type="String"></Data>
      </Cell>
      <% end %>
    </Row>
    <% end %>
  </Table>
</Worksheet>
</Workbook>